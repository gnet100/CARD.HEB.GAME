<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>砖拽 专 - 专住转 拽转</title>
    <style>
        body { margin: 0; overflow: hidden; font-family: sans-serif; background: #e0f2f1; touch-action: none; }
        #menu, #victory { position: absolute; inset: 0; background: white; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; text-align: center; }
        .option-group { margin: 10px; padding: 15px; border: 1px solid #ccc; border-radius: 10px; width: 80%; }
        button { padding: 15px 25px; font-size: 1.2rem; cursor: pointer; border: none; border-radius: 8px; background: #26a69a; color: white; margin: 5px; }
        .hidden { display: none !important; }
        canvas { display: block; background: #e0f2f1; }
    </style>
</head>
<body>

<div id="menu">
    <h1>砖拽 专 砖</h1>
    <div class="option-group">
        <p>专转:</p>
        <button onclick="setSpeed(1.2)">爪</button>
        <button onclick="setSpeed(2.5)">专</button>
        <button onclick="setSpeed(4.5)">爪'</button>
    </div>
    <div class="option-group">
        <p>转 转 (4-8): <span id="pairValue">5</span></p>
        <input type="range" id="pairCount" min="4" max="8" value="5">
    </div>
    <div class="option-group">
        <button id="toggleNikud" onclick="toggleNikud()">拽: 驻注</button>
    </div>
    <button onclick="startGame()" style="background:#00796b;">转!</button>
</div>

<div id="victory" class="hidden">
    <h1> ! 爪转! </h1>
    <button onclick="location.reload()">砖拽 砖</button>
</div>

<canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const pairInput = document.getElementById('pairCount');
    const pairValueDisplay = document.getElementById('pairValue');
    pairInput.oninput = () => pairValueDisplay.innerText = pairInput.value;

    let speedMultiplier = 2.5;
    let maxPairs = 5;
    let useNikud = true;
    let gameActive = false;
    let cards = [];
    let selectedFirst = null;
    let currentGoalPairs = 1;
    let isPausedForEffect = false;

    const cardData = [
        { id: 'ant', nikud: '', plain: '' },
        { id: 'baby', nikud: '转旨执拽', plain: '转拽' },
        { id: 'cake', nikud: '注', plain: '注' },
        { id: 'cat', nikud: '转', plain: '转' },
        { id: 'dog', nikud: '旨侄侄', plain: '' },
        { id: 'egg', nikud: '旨值爪指', plain: '爪' },
        { id: 'fish', nikud: '', plain: '' },
        { id: 'flower', nikud: '驻旨侄专址', plain: '驻专' },
        { id: 'foot', nikud: '专', plain: '专' },
        { id: 'girl', nikud: '', plain: '' },
        { id: 'hamster', nikud: '专', plain: '专' },
        { id: 'hand', nikud: '', plain: '' },
        { id: 'house', nikud: '旨址转', plain: '转' },
        { id: 'moon', nikud: '专', plain: '专' },
        { id: 'fire', nikud: '砖', plain: '砖' },
        { id: 'sand', nikud: '', plain: '' },
        { id: 'salt', nikud: '', plain: '' },
        { id: 'spoon', nikud: